# java-convenience-store-precourse

# 🎯 목표

---

구매자의 할인 혜택과 재고 상황을 고려하여 최종 결제 금액을 계산하고 안내하는 편의점의 결제 시스템을 구현한다.
```
- 관련 함수를 묶어 클래스를 만들고, 객체들이 협력하여 하나의 큰 기능을 수행하도록 한다.
- 클래스와 함수에 대한 단위 테스트를 통해 의도한 대로 정확하게 작동하는 영역을 확보한다.
- 3주 차 공통 피드백을 최대한 반영한다.
```
```
메소드 길이는 10을 넘어서는 안된다.
```

## 🔖 구현 기능 목록

---

### 구매할 상품과 수량을 입력 받는다.
[콜라-1],[사이다-2] 와 같은 형식으로 입력받는다.

### 입력받은 구매 상품의 재고를 확인한다.
결제를 진행하기 앞서 재고를 확인해야 한다. 재고 확인 후 문제없다면 진행한다.
1. 재고 검사 중에 프로모션이 있다면 이와 관련한 정보를 넘긴다. (프로모션 할일 가능 검사)

### 프로모션 할인 가능 여부를 검사한다.
1. 재고 검사 후 프로모션 할인이 가능한지에 대한 자세한 정보를 받는다. (프로모션 재고만 가능하다!)
2. 프로모션 할인이 가능하다면 할인 금액을 계산한다. 1+1이라면, 1개 수량이 1000원일 때, 1개는 무료이므로 할인 금액은 1000원입니다.
3. 고객이 프로모션 제품을 적게 가져오면, 필요한 수량을 가져오면 혜택을 받을 수 있음을 알려준다.
4. 프로모션 재고 부족으로 할인이 불가능하면, 일부 수량에 대해 정가로 결제하게 된다. (예 : 2+1인데 프로모션 재고가 2개밖에 없을 때 그 2개를 정가로 결제한다.)

프로모션 할인 진행
적어도 일반 재고는 충분하다는 가정하에 진행
1. 프로모션 할인 가능 여부 확인
2. 구매할 상품의 수량 프로모션 적용 적합 검사
   프로모션 재고 적합 여부에 따라 다음과 같이 2가지로 나눠서 진행
   2-1. 구매수량이 부족하다면 구매상품을 1개 추가해서 프로모션 할인 적용 의사 묻기
   2-1-1. 고객이 프로모션 적용 수량만큼 가져오지 않았다면 진행하는 것.
   2-1-2. 프로모션 재고가 충분할 때
   2-1-3. N이라고 답하면 할인적용갯수만 빼고 나머지 정가계산
   2-2. 프로모션 적용수량을 초과했다면 해당 분량만큼 정가로 결제 의사 묻기
   2-2-1. N이라고 답한다면 재시작.
   2-2-2. Y면 할인적용갯수만큼 빼고 나머지 정가계산
   시간 아까우니 부족분과 초과분 모두 하나의 상품일 때만 구현
   2-3. 두 가지 경우를 따로 구현
3. 프로모션 진행
4. 프로모션을 진행하며 영수증 작성

### 사용자가 동의하면 멤버쉽 할인을 적용한다.
모든 사용자는 멤버쉽 할인이 가능하다고 판단한다.
1. 할인은 최대 **8000원**이다.
2. 프로모션 미적용 금액의 30%를 할인한다. (예 : 예시의 13000원 중 프로모션 금액 3000원을 제한 1만원에 30% 할인 적용)

### 결제를 진행한다.
1. 총 구매액과 할인 내역에 대한 정보를 영수증으로 넘긴다.
2. 재고에서 구매한 내역을 차감한다.

### 종합적인 내역이 담긴 영수증을 출력한다.
구매액과 할인 내역을 받아 영수증을 출력한다.
영수증의 내역은 다음과 같다.
- 구매 상품 내역: 구매한 상품명, 수량, 가격
- 증정 상품 내역: 프로모션에 따라 무료로 제공된 증정 상품의 목록
- 금액 정보 
  - 총구매액: 구매한 상품의 총 수량과 총 금액
  - 행사할인: 프로모션에 의해 할인된 금액
  - 멤버십할인: 멤버십에 의해 추가로 할인된 금액
  - 내실돈: 최종 결제 금액

**예시**

    ==============W 편의점================
    상품명		수량	금액
    콜라		3 	3,000
    에너지바 	5 	10,000
    =============증	정===============
    콜라		1
    ====================================
    총구매액		8	13,000
    행사할인			-1,000
    멤버십할인		-3,000
    내실돈			 9,000

### 상품 정보를 가져와 저장(초기화)한다.
resources/*.md 파일에 있는 상품 정보를 가져와 java 프로그램에서 사용할 수 있도록 저장한다.
파일의 데이터에서 상품은 Map으로, 프로모션은 Enum으로 각각 관리하려 했지만 프로모션은 추가 및 삭제 수정이 자유롭다. 따라서 변동에 대응할 수 있도록 List 자료구조를 채용했다.
- 프로모션 재고가 있는데 일반 재고가 없으면 일반 재고를 0이라 하고 스토리지에 포함한다.
1. 프로모션 재고 먼저 탐색
2. 프로모션 재고가 0이 됐고, 차감할 구매수량이 남았다면 일반 재고 탐색
### 결제 이후 추가 구매 여부를 묻는다.
Y는 추가 구매로 이행한다는 의미고, N은 종료한다는 의미이다.


## 📝 예외 상황

---

1. 구매할 상품과 수량 형식이 올바르지 않은 경우 (예 : [콜라=1],[사이다*2])

2. Y 또는 N이 아닌 다른 문자를 입력한 경우 (예 : "y" 또는 "n", "yes" 또는 "no")

3. 재고가 부족한 경우, 초과한 경우(예 : 콜라 1개만 남았는데 2개를 구매하려고 할 때, 프로모션 예외)

4. 재고가 아예 없을 경우 (예 : 콜라 재고가 0개인데 1개 이상 구입할 때)

5. 구매상품 전체가 프로모션 할인된 경우, 멤버쉽이 불가함.
